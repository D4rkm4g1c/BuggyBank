{% extends "base.html" %}

{% block title %}Search - BuggyBank{% endblock %}

{% block content %}
<div class="card">
    <h1>Search</h1>
    
    <form method="GET">
        <div class="form-group">
            <label for="q">Search Query:</label>
            <input type="text" id="q" name="q" value="{{ query }}" placeholder="Enter your search query...">
        </div>
        
        <button type="submit" class="btn">Search</button>
    </form>
</div>

<div class="card">
    <h2>Search Results</h2>
    <div id="results">
        <!-- Vulnerable: DOM XSS - user input reflected in innerHTML -->
        <script>
            // Vulnerable: Direct innerHTML assignment without sanitization
            document.getElementById('results').innerHTML = "{{ query|safe }}";
        </script>
    </div>
</div>

<div class="card">
    <h3>Vulnerability Details</h3>
    <ul>
        <li><strong>DOM XSS:</strong> User input is directly assigned to innerHTML</li>
        <li><strong>No Sanitization:</strong> HTML and JavaScript in search query is executed</li>
        <li><strong>Example Exploits:</strong></li>
        <ul>
            <li><code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code></li>
            <li><code>&lt;img src=x onerror=alert('XSS')&gt;</code></li>
            <li><code>&lt;iframe src="javascript:alert('XSS')"&gt;&lt;/iframe&gt;</code></li>
        </ul>
    </ul>
</div>
{% endblock %} 