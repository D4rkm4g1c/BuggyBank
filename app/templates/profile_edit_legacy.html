{% extends "base.html" %}

{% block title %}Legacy Profile Editor - BuggyBank{% endblock %}

{% block content %}
<div class="card">
    <h1>Legacy Profile Editor</h1>
    <p><em>This is the old profile editor (Forced Browsing vulnerability)</em></p>
    
    <form method="POST">
        <!-- Vulnerable: No CSRF token -->
        <div class="form-group">
            <label for="name">Username:</label>
            <input type="text" id="name" name="name" value="{{ user[1] }}" required>
            <!-- Vulnerable: No input validation - SQL injection possible -->
        </div>
        
        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" value="{{ user[3] }}" required>
            <!-- Vulnerable: No input validation -->
        </div>
        
        <button type="submit" class="btn">Update Profile</button>
    </form>
</div>

<div class="card">
    <h3>Vulnerability Details</h3>
    <ul>
        <li><strong>Forced Browsing:</strong> Hidden legacy profile editor</li>
        <li><strong>Missing Validation:</strong> No input sanitization</li>
        <li><strong>SQL Injection:</strong> Direct SQL queries with user input</li>
        <li><strong>XSS Vulnerable:</strong> User input not sanitized</li>
    </ul>
</div>
{% endblock %} 